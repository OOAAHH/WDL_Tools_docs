import{_ as i,c as a,a as n,o as h}from"./app-X5lNPt7J.js";const l={};function k(t,s){return h(),a("div",null,s[0]||(s[0]=[n(`<h2 id="写在前面" tabindex="-1"><a class="header-anchor" href="#写在前面"><span>写在前面</span></a></h2><p>SRA文件是NCBI的测序数据格式，通常用于存储高通量测序数据，有些情况下SRA的解析结果可能不如人意，我们这里给出了多个工作流的例子，对应不同的情况。</p><h2 id="示例" tabindex="-1"><a class="header-anchor" href="#示例"><span>示例</span></a></h2><p>整体上，我们的工作流的功能是：</p><ol><li>解析SRA文件</li><li>重命名文件</li><li>压缩文件</li></ol><h3 id="示例1-对于最常见的情况" tabindex="-1"><a class="header-anchor" href="#示例1-对于最常见的情况"><span>示例1：对于最常见的情况</span></a></h3><blockquote><p>代码的github<a href="https://github.com/rnacentre/WDL_Tools/blob/main/_SRAtoFastqgz" target="_blank" rel="noopener noreferrer">地址</a></p></blockquote><p>我们使用<code>1.1.1_SRAtoFastqgz.wdl</code>和<code>1.1.2_FastqgzNamed.wdl</code>，它们分别实现了对SRA的解析和按照Cellranger的格式重命名。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1.1</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">.</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_SRAtoFastqgz</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> </span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sratoolkit_tar_gz</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 10X</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> Genomics软件包路径</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> memory</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">8 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 内存</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">300 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 2</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1.1</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">.</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_FastqgzNamed</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Array[File]</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> fastq_file_paths</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件(数组)</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sample_name</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 重命名时使用的样本名</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">150 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 1</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然我们也有一个优化的版本：<code>1.1_SRAtoFasterqgz.wdl</code>，它使用了fasterq-dump工具，速度更快。并继承了重命名文件的逻辑。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1.1</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_SRAtoFasterqgz</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sratoolkit_tar_gz</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 10X</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> Genomics软件包路径</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sample</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 重命名时使用的样本名</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> memory</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">8 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 内存</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">300 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 8</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例2-对于比较复杂的情况" tabindex="-1"><a class="header-anchor" href="#示例2-对于比较复杂的情况"><span>示例2：对于比较复杂的情况</span></a></h3><p>对于空间转录组和VDJ的数据，我们可能需要考虑使用<code>--split-3</code>还是<code>--split-files</code>参数。此外，某些时候我们很难直接判断SRA解析出的fastq数据的身份，到底谁是R1，谁是R2，尤其是对于VDJ数据。VDJ的fastq数据在尺寸上非常接近，有经验的生物信息学工程师可以凭借经验判断（比如直接观察文件保守序列的情况，<mark>在文件非常多的时候这是不现实的</mark>），但对于新手来说，可能需要一些额外的帮助。</p><p>我们在这里利用了VDJ的R1文件具备大量保守序列的特点来设计一个特殊的方法。从计算机存储数据的角度来看，保守序列越多，文件中重复的字段就应该越多，理论上我们可以通过计算文件中重复字段的比例来判断文件的身份。考虑到我们需要把文件转换为fastq.gz的形式，我们利用pigz工具来实现这样的想法。具体而言，当我们尝试让pigz用最大的压缩率压缩文件，此时pigz会尝试主动寻找文件中的重复的部分来提高压缩率。<mark>如果文件中重复字段越多，压缩率就会越高，反之则越低。压缩率越高则文件越小，反之则越大</mark>。这样我们就在原有代码改动最小的情况下，实现了对VDJ数据R1和R2的区分。</p><blockquote><p>对应的代码在<code>1.3_newNamedLogic.wdl</code>以及<code>1.4_newNamedLogic_split3.wdl</code>。分别对应<code>--split-files</code>和<code>--split-3</code>两种情况。</p></blockquote><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1.3</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_newNamedLogic 对应--split-files</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sratoolkit_tar_gz</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 10X</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> Genomics软件包路径</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sample</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 重命名时使用的样本名</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> memory</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 内存</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> lane</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 测序lane</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1.4</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_newNamedLogic_split</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> 对应--split</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">-3</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sratoolkit_tar_gz</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 10X</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> Genomics软件包路径</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sample</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 重命名时使用的样本名</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> memory</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 内存</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> lane</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 测序lane</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例3-迈向更加集约化的工作流" tabindex="-1"><a class="header-anchor" href="#示例3-迈向更加集约化的工作流"><span>示例3：迈向更加集约化的工作流</span></a></h3><blockquote><p>我们面临的场景是大规模的数据分析，因此1%的性能提升也是值得的。</p></blockquote><p>在《WDL 代码模式，最简代码模式》中，我们给出了一个加速开发的想法，使用WDL内封装您提前构建的python脚本，这样我们只需要考虑如何处理文件和变量的传递，降低迁移成本。</p><p>我们在这里展示一个使用rust程序替代python脚本的例子，这直接带来了12%的性能提升。</p><p>文件在<code>2.1_newNamedLogic_Rust.wdl</code>，使用方式上稍有不同，现在split-3和split-files的参数需要通过<code>--split-3</code>和<code>--split-files</code>来指定。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"># </span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">2.1</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">_newNamedLogic_Rust</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> this.sra_file</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 输入的SRA文件</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    File</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sratoolkit_tar_gz</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 10X</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> Genomics软件包路径</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> sample</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">sample</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 重命名时使用的样本名</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> memory</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">8 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 内存</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> disk_space</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">300 GB</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 数据盘尺寸</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    Int</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> cpu</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 8</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 核数</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> lane</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">L001</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 测序lane</span></span>
<span class="line"><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;">    String</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> split_option</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> =</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#0451A5;--shiki-dark:#C792EA;">--split-files</span><span style="--shiki-light:#0451A5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> #</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 解析参数,</span><span style="--shiki-light:#CD3131;--shiki-dark:#FF5370;"> 对应--split-3和--split-files</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>rust程序的代码在<code>_SRAtoFastqgz/2.0_rust/rustFiles/src/main.rs</code>，它被封装在<code>2.1_newNamedLogic_Rust.wdl</code>中。</p><div class="language-rust line-numbers-mode has-collapsed collapsed" data-ext="rust" data-title="rust" style="--vp-collapsed-lines:10;"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes light-plus aurora-x vp-code"><code><span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">// 2.1_newNamedLogic_Rust.rs</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> clap</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">Parser</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> regex</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">Regex</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">collections</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">HashMap</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">env</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">fs</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">process</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">Command</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">use</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> glob</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">glob</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">#[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">derive</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">Parser</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Debug</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">#[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">command</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">author</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> version</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> about</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long_about </span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">=</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> None</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">struct</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Args</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    /// Sample name</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    #[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">short</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">    sample</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    /// Lane</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    #[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">short</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">    lane</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    /// Number of CPUs</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    #[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">short</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> default_value_t </span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">=</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> 1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">    cpu</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> usize</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    /// Path to sratoolkit tar.gz file</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    #[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">short</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">    sratoolkit_tar_gz</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    /// Path to SRA file</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    #[</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">short</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;"> long</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)]</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">    sra_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">fn</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> main</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> -&gt;</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Result</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&lt;(),</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Box</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">dyn</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">error</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">Error</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&gt;&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">parse</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Replace &#39;.&#39; with &#39;_&#39; in sample name</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sample</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">sample</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">replace</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">.</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;"> &quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> lane</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">lane</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Create sratoolkit directory</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">    fs</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">create_dir_all</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">sratoolkit</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Extract sratoolkit tar.gz file</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> tar_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Command</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">tar</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">-xzf</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">&amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">sratoolkit_tar_gz</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">-C</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">sratoolkit</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">--strip-components</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">1</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">status</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> !</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">tar_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">success</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">        eprintln!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Failed to extract sratoolkit tar.gz file.</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">process</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">exit</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Update PATH to include sratoolkit/bin</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> current_dir</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> env</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">current_dir</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sratoolkit_bin</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> current_dir</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">join</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">sratoolkit</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">join</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">bin</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> path_var</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> env</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">var</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">PATH</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">unwrap_or_default</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> new_path</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> format!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">:</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sratoolkit_bin</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">display</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(),</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> path_var</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">    env</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">set_var</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">PATH</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> &amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">new_path</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Run fasterq-dump</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> fasterq_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Command</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">fasterq-dump</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">--split-files</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">-e</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">cpu</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">to_string</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">())</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">--include-technical</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">&amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">sra_file</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">        .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">status</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> !</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">fasterq_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">success</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">        eprintln!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Failed to run fasterq-dump.</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">process</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">exit</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Find all .fastq files</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> files</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Vec</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Vec</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    for</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> entry</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;"> in</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> glob</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">*.fastq</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">        match</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> entry</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">            Ok</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">path</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">                if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> path</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">to_str</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">                    files</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">push</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">filename</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">to_string</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">());</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">                }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">            }</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">            Err</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">e</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> eprintln!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Error reading file: </span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">:?</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">}&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> e</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">),</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Map files based on suffix</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> re</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Regex</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">r</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_(\\d)\\.fastq$</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">unwrap</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> HashMap</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> HashMap</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    for</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> f</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;"> in</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> files</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">        if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">caps</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> re</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">captures</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">&amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">f</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">            let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> suffix</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> caps</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">unwrap</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">as_str</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">to_string</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">insert</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">suffix</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> f</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Initialize variables to hold file paths</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> None</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> None</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> None</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> None</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    match</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">len</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">        2</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">1</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">2</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">        3</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            i1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">1</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">2</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">3</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">        4</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            i1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">1</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            i2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">2</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r1_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">3</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">            r2_file</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> file_suffixes</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">get</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">4</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">cloned</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">        _</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">            eprintln!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Unexpected number of .fastq files.</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">            std</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">process</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">exit</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#098658;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Define new filenames and list to compress</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">    let</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> mut</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">:</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Vec</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">String</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Vec</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">ref</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i1_file</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">        let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> format!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_S1_</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_I1_001.fastq</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sample</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> lane</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        fs</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">copy</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> &amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">        new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">push</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">ref</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i2</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i2_file</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">        let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> i2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> format!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_S1_</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_I2_001.fastq</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sample</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> lane</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        fs</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">copy</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i2</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> &amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">        new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">push</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">i2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">ref</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r1_file</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">        let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> format!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_S1_</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_R1_001.fastq</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sample</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> lane</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        fs</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">copy</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r1</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> &amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">        new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">push</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r1_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    if</span><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;"> let</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Some</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;">ref</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r2</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r2_file</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">        let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> r2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;"> format!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_S1_</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">_R2_001.fastq</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> sample</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> lane</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">        fs</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">copy</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r2</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> &amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">        new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">push</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">r2_new_filename</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-light-font-style:inherit;--shiki-dark:#546E7A;--shiki-dark-font-style:italic;">    // Compress the new files with pigz</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">    for</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> fastq</span><span style="--shiki-light:#0000FF;--shiki-dark:#F78C6C;"> in</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> new_filenames</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#C792EA;">        let</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> pigz_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;"> =</span><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;"> Command</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">::</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">new</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">pigz</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">            .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">-p</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">            .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">args</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#000000;--shiki-dark:#BBBBBB;">cpu</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">to_string</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">())</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">            .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">arg</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">&amp;</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;">fastq</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">            .</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">status</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">?</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;">        if</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> pigz_status</span><span style="--shiki-light:#000000;--shiki-dark:#C792EA;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">success</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">            println!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Successfully compressed: </span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> fastq</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span><span style="--shiki-light:#AF00DB;--shiki-dark:#89DDFF;"> else</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#82AAFF;">            eprintln!</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#A31515;--shiki-dark:#C3E88D;">Failed to compress: </span><span style="--shiki-light:#A31515;--shiki-dark:#89DDFF;">{}&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#001080;--shiki-dark:#EEFFFF;"> fastq</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#267F99;--shiki-dark:#FFCB6B;">    Ok</span><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">(())</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#89DDFF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div>`,26)]))}const e=i(l,[["render",k],["__file","index.html.vue"]]),F=JSON.parse('{"path":"/01_10X_Genomics/411xd9jc/","title":"SRA2Fastq","lang":"zh-CN","frontmatter":{"title":"SRA2Fastq","createTime":"2024/12/10 14:35:47","permalink":"/01_10X_Genomics/411xd9jc/","description":"写在前面 SRA文件是NCBI的测序数据格式，通常用于存储高通量测序数据，有些情况下SRA的解析结果可能不如人意，我们这里给出了多个工作流的例子，对应不同的情况。 示例 整体上，我们的工作流的功能是： 解析SRA文件 重命名文件 压缩文件 示例1：对于最常见的情况 代码的github地址 我们使用1.1.1_SRAtoFastqgz.wdl和1.1.2...","head":[["meta",{"property":"og:url","content":"https://WDL_Tools_docs/WDL_Tools_docs/01_10X_Genomics/411xd9jc/"}],["meta",{"property":"og:site_name","content":"RiboCV"}],["meta",{"property":"og:title","content":"SRA2Fastq"}],["meta",{"property":"og:description","content":"写在前面 SRA文件是NCBI的测序数据格式，通常用于存储高通量测序数据，有些情况下SRA的解析结果可能不如人意，我们这里给出了多个工作流的例子，对应不同的情况。 示例 整体上，我们的工作流的功能是： 解析SRA文件 重命名文件 压缩文件 示例1：对于最常见的情况 代码的github地址 我们使用1.1.1_SRAtoFastqgz.wdl和1.1.2..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-10T10:07:22.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-10T10:07:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SRA2Fastq\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-10T10:07:22.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"写在前面","slug":"写在前面","link":"#写在前面","children":[]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[{"level":3,"title":"示例1：对于最常见的情况","slug":"示例1-对于最常见的情况","link":"#示例1-对于最常见的情况","children":[]},{"level":3,"title":"示例2：对于比较复杂的情况","slug":"示例2-对于比较复杂的情况","link":"#示例2-对于比较复杂的情况","children":[]},{"level":3,"title":"示例3：迈向更加集约化的工作流","slug":"示例3-迈向更加集约化的工作流","link":"#示例3-迈向更加集约化的工作流","children":[]}]}],"readingTime":{"minutes":5.46,"words":1639},"git":{"createdTime":1733814000000,"updatedTime":1733825242000,"contributors":[{"name":"Hughes","email":"hughes@Hughess-MacBook-Pro.local","commits":2}]},"autoDesc":true,"filePathRelative":"notes/01_10X_Genomics/SRA2Fastq.md","bulletin":false}');export{e as comp,F as data};
